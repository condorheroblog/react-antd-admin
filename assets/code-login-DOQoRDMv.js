import{w as ie,m as le,n as je,o as D,p as J,q as O,I as be,s as we,t as Ee,v as Te,j as s,u as W,B as R,b as Ne}from"./index-BTBW2FwQ.js";import{g as Pe,a as u,R as Ie,i as Fe,f as Se,L as te}from"./react-B2eEhSVY.js";import{al as _e,aA as N,aB as Y,aC as ke,aD as $,ad as C,k as V,aE as re,aF as U,z,T as G,aG as ce,s as Ae,ae as $e,j as Ce}from"./antd-C3AkHkw7.js";import{c as Le}from"./index-DO9Q1WR7.js";var Z,ne;function Oe(){return ne||(ne=1,Z={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Z}var Me=Oe();const Re=Pe(Me);var De=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function se(e){var n={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},t=e.match(/<\/?([^\s]+?)[/\s>]/);if(t&&(n.name=t[1],(Re[t[1]]||e.charAt(e.length-2)==="/")&&(n.voidElement=!0),n.name.startsWith("!--"))){var r=e.indexOf("-->");return{type:"comment",comment:r!==-1?e.slice(4,r):""}}for(var o=new RegExp(De),a=null;(a=o.exec(e))!==null;)if(a[0].trim())if(a[1]){var i=a[1].trim(),m=[i,""];i.indexOf("=")>-1&&(m=i.split("=")),n.attrs[m[0]]=m[1],o.lastIndex--}else a[2]&&(n.attrs[a[2]]=a[3].trim().substring(1,a[3].length-1));return n}var Ve=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,qe=/^\s*$/,Be=Object.create(null);function ue(e,n){switch(n.type){case"text":return e+n.content;case"tag":return e+="<"+n.name+(n.attrs?function(t){var r=[];for(var o in t)r.push(o+'="'+t[o]+'"');return r.length?" "+r.join(" "):""}(n.attrs):"")+(n.voidElement?"/>":">"),n.voidElement?e:e+n.children.reduce(ue,"")+"</"+n.name+">";case"comment":return e+"<!--"+n.comment+"-->"}}var He={parse:function(e,n){n||(n={}),n.components||(n.components=Be);var t,r=[],o=[],a=-1,i=!1;if(e.indexOf("<")!==0){var m=e.indexOf("<");r.push({type:"text",content:m===-1?e:e.substring(0,m)})}return e.replace(Ve,function(f,y){if(i){if(f!=="</"+t.name+">")return;i=!1}var p,h=f.charAt(1)!=="/",j=f.startsWith("<!--"),v=y+f.length,d=e.charAt(v);if(j){var F=se(f);return a<0?(r.push(F),r):((p=o[a]).children.push(F),r)}if(h&&(a++,(t=se(f)).type==="tag"&&n.components[t.name]&&(t.type="component",i=!0),t.voidElement||i||!d||d==="<"||t.children.push({type:"text",content:e.slice(v,e.indexOf("<",v))}),a===0&&r.push(t),(p=o[a-1])&&p.children.push(t),o[a]=t),(!h||t.voidElement)&&(a>-1&&(t.voidElement||t.name===f.slice(2,-1))&&(a--,t=a===-1?r:o[a]),!i&&d!=="<"&&d)){p=a===-1?r:o[a].children;var l=e.indexOf("<",v),x=e.slice(v,l===-1?void 0:l);qe.test(x)&&(x=" "),(l>-1&&a+p.length>=0||x!==" ")&&p.push({type:"text",content:x})}}),r},stringify:function(e){return e.reduce(function(n,t){return n+ue("",t)},"")}};const K=(e,n)=>{var r;if(!e)return!1;const t=((r=e.props)==null?void 0:r.children)??e.children;return n?t.length>0:!!t},Q=e=>{var t,r;if(!e)return[];const n=((t=e.props)==null?void 0:t.children)??e.children;return(r=e.props)!=null&&r.i18nIsDynamicList?M(n):n},Ue=e=>Array.isArray(e)&&e.every(u.isValidElement),M=e=>Array.isArray(e)?e:[e],We=(e,n)=>{const t={...n};return t.props=Object.assign(e.props,n.props),t},me=(e,n,t,r)=>{if(!e)return"";let o="";const a=M(e),i=n!=null&&n.transSupportBasicHtmlNodes?n.transKeepBasicHtmlNodesFor??[]:[];return a.forEach((m,f)=>{if(D(m)){o+=`${m}`;return}if(u.isValidElement(m)){const{props:y,type:p}=m,h=Object.keys(y).length,j=i.indexOf(p)>-1,v=y.children;if(!v&&j&&!h){o+=`<${p}/>`;return}if(!v&&(!j||h)||y.i18nIsDynamicList){o+=`<${f}></${f}>`;return}if(j&&h===1&&D(v)){o+=`<${p}>${v}</${p}>`;return}const d=me(v,n,t,r);o+=`<${f}>${d}</${f}>`;return}if(m===null){J(t,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:r});return}if(O(m)){const{format:y,...p}=m,h=Object.keys(p);if(h.length===1){const j=y?`${h[0]}, ${y}`:h[0];o+=`{{${j}}}`;return}J(t,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:r,child:m});return}J(t,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:r,child:m})}),o},ze=(e,n,t,r,o,a)=>{if(n==="")return[];const i=r.transKeepBasicHtmlNodesFor||[],m=n&&new RegExp(i.map(l=>`<${l}`).join("|")).test(n);if(!e&&!m&&!a)return[n];const f={},y=l=>{M(l).forEach(g=>{D(g)||(K(g)?y(Q(g)):O(g)&&!u.isValidElement(g)&&Object.assign(f,g))})};y(e);const p=He.parse(`<0>${n}</0>`),h={...f,...o},j=(l,x,g)=>{var b;const I=Q(l),k=d(I,x.children,g);return Ue(I)&&k.length===0||(b=l.props)!=null&&b.i18nIsDynamicList?I:k},v=(l,x,g,I,k)=>{l.dummy?(l.children=x,g.push(u.cloneElement(l,{key:I},k?void 0:x))):g.push(...u.Children.map([l],b=>{const c={...b.props};return delete c.i18nIsDynamicList,u.createElement(b.type,{...c,key:I,ref:b.ref},k?null:x)}))},d=(l,x,g)=>{const I=M(l);return M(x).reduce((b,c,E)=>{var A,T;const _=((T=(A=c.children)==null?void 0:A[0])==null?void 0:T.content)&&t.services.interpolator.interpolate(c.children[0].content,h,t.language);if(c.type==="tag"){let w=I[parseInt(c.name,10)];g.length===1&&!w&&(w=g[0][c.name]),w||(w={});const P=Object.keys(c.attrs).length!==0?We({props:c.attrs},w):w,L=u.isValidElement(P),q=L&&K(c,!0)&&!c.voidElement,B=m&&O(P)&&P.dummy&&!L,H=O(e)&&Object.hasOwnProperty.call(e,c.name);if(D(P)){const S=t.services.interpolator.interpolate(P,h,t.language);b.push(S)}else if(K(P)||q){const S=j(P,c,g);v(P,S,b,E)}else if(B){const S=d(I,c.children,g);v(P,S,b,E)}else if(Number.isNaN(parseFloat(c.name)))if(H){const S=j(P,c,g);v(P,S,b,E,c.voidElement)}else if(r.transSupportBasicHtmlNodes&&i.indexOf(c.name)>-1)if(c.voidElement)b.push(u.createElement(c.name,{key:`${c.name}-${E}`}));else{const S=d(I,c.children,g);b.push(u.createElement(c.name,{key:`${c.name}-${E}`},S))}else if(c.voidElement)b.push(`<${c.name} />`);else{const S=d(I,c.children,g);b.push(`<${c.name}>${S}</${c.name}>`)}else if(O(P)&&!L){const S=c.children[0]?_:null;S&&b.push(S)}else v(P,_,b,E,c.children.length!==1||!_)}else if(c.type==="text"){const w=r.transWrapTextNodes,P=a?r.unescape(t.services.interpolator.interpolate(c.content,h,t.language)):t.services.interpolator.interpolate(c.content,h,t.language);w?b.push(u.createElement(w,{key:`${c.name}-${E}`},P)):b.push(P)}return b},[])},F=d([{dummy:!0,children:e||[]}],p,M(e||[]));return Q(F[0])},de=(e,n,t)=>{const r=e.key||n,o=u.cloneElement(e,{key:r});if(!o.props||!o.props.children||t.indexOf(`${n}/>`)<0&&t.indexOf(`${n} />`)<0)return o;function a(){return u.createElement(u.Fragment,null,o)}return u.createElement(a,{key:r})},Ge=(e,n)=>e.map((t,r)=>de(t,r,n)),Xe=(e,n)=>{const t={};return Object.keys(e).forEach(r=>{Object.assign(t,{[r]:de(e[r],r,n)})}),t},Je=(e,n,t,r)=>e?Array.isArray(e)?Ge(e,n):O(e)?Xe(e,n):(ie(t,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:r}),null):null;function Ye({children:e,count:n,parent:t,i18nKey:r,context:o,tOptions:a={},values:i,defaults:m,components:f,ns:y,i18n:p,t:h,shouldUnescape:j,...v}){var P,L,q,B,H,S;const d=p||le();if(!d)return ie(d,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:r}),e;const F=h||d.t.bind(d)||(xe=>xe),l={...je(),...(P=d.options)==null?void 0:P.react};let x=y||F.ns||((L=d.options)==null?void 0:L.defaultNS);x=D(x)?[x]:x||["translation"];const g=me(e,l,d,r),I=m||g||l.transEmptyNodeValue||r,{hashTransKey:k}=l,b=r||(k?k(g||I):g||I);(B=(q=d.options)==null?void 0:q.interpolation)!=null&&B.defaultVariables&&(i=i&&Object.keys(i).length>0?{...i,...d.options.interpolation.defaultVariables}:{...d.options.interpolation.defaultVariables});const c=i||n!==void 0&&!((S=(H=d.options)==null?void 0:H.interpolation)!=null&&S.alwaysFormat)||!e?a.interpolation:{interpolation:{...a.interpolation,prefix:"#$?",suffix:"?$#"}},E={...a,context:o||a.context,count:n,...i,...c,defaultValue:I,ns:x},_=b?F(b,E):I,A=Je(f,_,d,r),T=ze(A||e,_,d,l,E,j),w=t??l.defaultTransParent;return w?u.createElement(w,v,T):T}function Ze({children:e,count:n,parent:t,i18nKey:r,context:o,tOptions:a={},values:i,defaults:m,components:f,ns:y,i18n:p,t:h,shouldUnescape:j,...v}){var g;const{i18n:d,defaultNS:F}=u.useContext(be)||{},l=p||d||le(),x=h||(l==null?void 0:l.t.bind(l));return Ye({children:e,count:n,parent:t,i18nKey:r,context:o,tOptions:a,values:i,defaults:m,components:f,ns:y||(x==null?void 0:x.ns)||F||((g=l==null?void 0:l.options)==null?void 0:g.defaultNS),i18n:l,t:h,shouldUnescape:j,...v})}var ee=function(e){if(!e)return 0;var n=_e(e).valueOf()-Date.now();return n<0?0:n},Ke=function(e){return{days:Math.floor(e/864e5),hours:Math.floor(e/36e5)%24,minutes:Math.floor(e/6e4)%60,seconds:Math.floor(e/1e3)%60,milliseconds:Math.floor(e)%1e3}},Qe=function(e){e===void 0&&(e={});var n=e||{},t=n.leftTime,r=n.targetDate,o=n.interval,a=o===void 0?1e3:o,i=n.onEnd,m=u.useMemo(function(){return we(t)&&t>0?Date.now()+t:void 0},[t]),f="leftTime"in e?m:r,y=Ee(u.useState(function(){return ee(f)}),2),p=y[0],h=y[1],j=Te(i);u.useEffect(function(){if(!f){h(0);return}h(ee(f));var d=setInterval(function(){var F,l=ee(f);h(l),l===0&&(clearInterval(d),(F=j.current)===null||F===void 0||F.call(j))},a);return function(){return clearInterval(d)}},[f,a]);var v=u.useMemo(function(){return Ke(p)},[p]);return[p,v]},et=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],tt=Ie.forwardRef(function(e,n){var t=N.useFormInstance(),r=u.useState(e.countDown||60),o=Y(r,2),a=o[0],i=o[1],m=u.useState(!1),f=Y(m,2),y=f[0],p=f[1],h=u.useState(),j=Y(h,2),v=j[0],d=j[1];e.rules,e.name;var F=e.phoneName,l=e.fieldProps,x=e.onTiming,g=e.captchaTextRender,I=g===void 0?function(E,_){return E?"".concat(_," 秒后重新获取"):"获取验证码"}:g,k=e.captchaProps,b=ke(e,et),c=function(){var E=re(U().mark(function _(A){return U().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.prev=0,d(!0),w.next=4,b.onGetCaptcha(A);case 4:d(!1),p(!0),w.next=13;break;case 8:w.prev=8,w.t0=w.catch(0),p(!1),d(!1),console.log(w.t0);case 13:case"end":return w.stop()}},_,null,[[0,8]])}));return function(A){return E.apply(this,arguments)}}();return u.useImperativeHandle(n,function(){return{startTiming:function(){return p(!0)},endTiming:function(){return p(!1)}}}),u.useEffect(function(){var E=0,_=e.countDown;return y&&(E=window.setInterval(function(){i(function(A){return A<=1?(p(!1),clearInterval(E),_||60):A-1})},1e3)),function(){return clearInterval(E)}},[y]),u.useEffect(function(){x&&x(a)},[a,x]),s.jsxs("div",{style:$($({},l==null?void 0:l.style),{},{display:"flex",alignItems:"center"}),ref:n,children:[s.jsx(C,$($({},l),{},{style:$({flex:1,transition:"width .3s",marginRight:8},l==null?void 0:l.style)})),s.jsx(V,$($({style:{display:"block"},disabled:y,loading:v},k),{},{onClick:re(U().mark(function E(){var _;return U().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(T.prev=0,!F){T.next=9;break}return T.next=4,t.validateFields([F].flat(1));case 4:return _=t.getFieldValue([F].flat(1)),T.next=7,c(_);case 7:T.next=11;break;case 9:return T.next=11,c("");case 11:T.next=16;break;case 13:T.prev=13,T.t0=T.catch(0),console.log(T.t0);case 16:case"end":return T.stop()}},E,null,[[0,13]])})),children:I(y,a)}))]})}),rt=Le(tt);const nt=/^[\w-]{4,16}$/,st=/^(?:(?:\+|00)86)?1\d{10}$/;function fe(e){return[{required:!0,message:e("form.username.required")},{pattern:nt,message:e("form.username.invalid")}]}function pe(e){return[{required:!0,message:e("form.password.required")},{pattern:/^(?=.*\d)(?=.*[a-z])[\w~!@#$%^&*+.\-]{8,16}$/i,message:e("form.password.invalid")}]}function at(e){return[{required:!0,message:e("form.mobile.required")},{pattern:st,message:e("form.mobile.invalid")}]}const{Title:ot}=G,it={email:""};function he(){const[e,n]=u.useState(0),[t]=Qe({targetDate:e,onEnd:()=>{n(0)}}),[r,o]=u.useState(!1),[a]=N.useForm(),{t:i}=W(),{setFormMode:m}=u.useContext(X),f=async()=>{o(!0),n(new Date().getTime()+1e3*30),setTimeout(()=>{o(!1)},1e3)};return s.jsxs(s.Fragment,{children:[s.jsxs(z,{direction:"vertical",children:[s.jsx(ot,{level:3,children:i("authority.forgotPassword")}),s.jsx("p",{className:"text-xs opacity-80",children:i("authority.forgotPasswordSubtitle")})]}),s.jsxs(N,{name:"forgotForm",form:a,layout:"vertical",initialValues:it,onFinish:f,children:[s.jsx(N.Item,{label:i("authority.email"),name:"email",rules:[{required:!0},{type:"email",message:i("form.email.invalid")}],children:s.jsx(C,{placeholder:i("form.email.required")})}),s.jsx(N.Item,{children:s.jsx(V,{block:!0,type:"primary",htmlType:"submit",loading:r,disabled:t>0,children:t>0?i("authority.retryAfterText",{count:Math.floor(t/1e3)}):i("authority.sendResetLink")})}),s.jsx("div",{className:"text-sm text-center",children:s.jsx(R,{type:"link",icon:s.jsx(ce,{}),className:"px-1",onPointerDown:()=>{m("login")},children:i("common.back")})})]})]})}const gt=Object.freeze(Object.defineProperty({__proto__:null,ForgotPassword:he},Symbol.toStringTag,{value:"Module"})),{Title:ae}=G,lt={username:"admin",password:"123456789admin"};function ge(){const[e,n]=u.useState(!1),[t]=N.useForm(),{t:r}=W(),[o,a]=Ae.useMessage(),[i]=Fe(),m=Se(),f=Ne(h=>h.login),{setFormMode:y}=u.useContext(X),p=async h=>{n(!0),o==null||o.loading(r("authority.loginInProgress"),0),f(h).then(()=>{var v;o==null||o.destroy(),(v=window.$message)==null||v.success(r("authority.loginSuccess"));const j=i.get("redirect");m(j?`/${j.slice(1)}`:"/home")}).finally(()=>{o==null||o.destroy(),setTimeout(()=>{var j;(j=window.$message)==null||j.destroy(),n(!1)},1e3)})};return s.jsxs(s.Fragment,{children:[a,s.jsxs(z,{direction:"vertical",children:[s.jsx(ae,{level:3,children:"Hello, Welcome to"}),s.jsx(ae,{className:"mt-0",level:5,children:"React Antd Admin"})]}),s.jsxs(N,{name:"passwordLoginForm",form:t,layout:"vertical",initialValues:lt,onFinish:p,children:[s.jsx(N.Item,{label:r("authority.username"),name:"username",rules:fe(r),children:s.jsx(C,{placeholder:r("form.username.required")})}),s.jsx(N.Item,{label:r("authority.password"),name:"password",rules:pe(r),children:s.jsx(C.Password,{placeholder:r("form.password.required")})}),s.jsxs(N.Item,{children:[s.jsxs("div",{className:"flex justify-between mb-5 -mt-1 text-sm",children:[s.jsx(R,{type:"link",className:"p-0",onPointerDown:()=>{y("codeLogin")},children:r("authority.codeLogin")}),s.jsx(R,{type:"link",className:"p-0",onPointerDown:()=>{y("forgotPassword")},children:r("authority.forgotPassword")})]}),s.jsx(V,{block:!0,type:"primary",htmlType:"submit",loading:e,children:r("authority.login")})]}),s.jsxs("div",{className:"text-sm text-center",children:[r("authority.noAccountYet"),s.jsx(R,{type:"link",className:"px-1",onPointerDown:()=>{y("register")},children:r("authority.goToRegister")})]})]})]})}const yt=Object.freeze(Object.defineProperty({__proto__:null,PasswordLogin:ge},Symbol.toStringTag,{value:"Module"})),{Title:oe}=G,ct={username:"",password:"",confirmPassword:""};function ye(){const[e]=u.useState(!1),[n]=N.useForm(),{t}=W(),{setFormMode:r}=u.useContext(X),o=async()=>{var a;(a=window.$message)==null||a.success("注册成功")};return s.jsxs(s.Fragment,{children:[s.jsxs(z,{direction:"vertical",children:[s.jsx(oe,{level:3,children:"Hello, Welcome to"}),s.jsx(oe,{className:"mt-0",level:5,children:"React Antd Admin"})]}),s.jsxs(N,{name:"registerForm",form:n,layout:"vertical",initialValues:ct,onFinish:o,children:[s.jsx(N.Item,{label:t("authority.username"),name:"username",rules:fe(t),children:s.jsx(C,{placeholder:t("form.username.required")})}),s.jsx(N.Item,{label:t("authority.password"),name:"password",rules:pe(t),children:s.jsx(C.Password,{placeholder:t("form.password.required")})}),s.jsx(N.Item,{name:"confirm",label:t("authority.confirmPassword"),dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:t("form.confirmPassword.required")},({getFieldValue:a})=>({validator(i,m){return!m||a("password")===m?Promise.resolve():Promise.reject(new Error(t("form.confirmPassword.invalid")))}})],children:s.jsx(C.Password,{placeholder:t("form.confirmPassword.required")})}),s.jsx(N.Item,{rules:[()=>({validator(a,i){return i!==!0?Promise.reject(new Error(t("form.agree.required"))):Promise.resolve()}})],name:"termsAgreement",valuePropName:"checked",children:s.jsx($e,{children:s.jsx("div",{className:"flex flex-wrap text-xs",children:s.jsx(Ze,{i18nKey:"authority.agree",components:[s.jsx(te,{to:"/terms-of-service",target:"_blank"},0),s.jsx(te,{to:"/privacy-policy",target:"_blank"},1)]})})})}),s.jsx(N.Item,{children:s.jsx(V,{block:!0,type:"primary",htmlType:"submit",loading:e,children:t("authority.register")})}),s.jsxs("div",{className:"text-sm text-center",children:[t("authority.alreadyHaveAnAccount"),s.jsx(R,{type:"link",className:"px-1",onPointerDown:()=>{r("login")},children:t("authority.goToLogin")})]})]})]})}const vt=Object.freeze(Object.defineProperty({__proto__:null,RegisterPassword:ye},Symbol.toStringTag,{value:"Module"})),xt={login:u.createElement(ge),register:u.createElement(ye),forgotPassword:u.createElement(he),codeLogin:u.createElement(ve)},X=u.createContext({formMode:"login",setFormMode:()=>{}}),{Title:ut}=G,mt={phoneNumber:"",captcha:""};function ve(){const[e,n]=u.useState(!1),[t]=N.useForm(),{t:r}=W(),{setFormMode:o}=u.useContext(X),a=async()=>{n(!0),setTimeout(()=>{var i;n(!1),(i=window.$message)==null||i.success(r("common.success"))},1e3)};return s.jsxs(s.Fragment,{children:[s.jsx(z,{direction:"vertical",children:s.jsx(ut,{level:3,children:r("authority.codeLogin")})}),s.jsxs(N,{name:"codeLoginForm",form:t,layout:"vertical",initialValues:mt,onFinish:a,children:[s.jsx(N.Item,{label:r("authority.mobile"),name:"phoneNumber",rules:at(r),children:s.jsx(Ce,{controls:!1,className:"w-full",placeholder:r("form.mobile.required")})}),s.jsx(rt,{label:r("authority.code"),placeholder:r("form.code.required"),captchaTextRender:(i,m)=>i?r("authority.sendText",{second:m}):r("authority.sendCode"),onGetCaptcha:()=>{var i;return(i=window.$message)==null||i.success(r("common.success")),Promise.resolve()},rules:[{required:!0}],phoneName:"phoneNumber",name:"captcha"}),s.jsx(N.Item,{children:s.jsx(V,{block:!0,type:"primary",htmlType:"submit",loading:e,children:r("authority.login")})}),s.jsx("div",{className:"text-sm text-center",children:s.jsx(R,{type:"link",icon:s.jsx(ce,{}),className:"px-1",onPointerDown:()=>{o("login")},children:r("common.back")})})]})]})}const jt=Object.freeze(Object.defineProperty({__proto__:null,CodeLogin:ve},Symbol.toStringTag,{value:"Module"}));export{X as F,xt as a,jt as c,gt as f,yt as p,vt as r};
