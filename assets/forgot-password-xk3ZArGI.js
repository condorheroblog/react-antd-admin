import{W as T,_ as F,X as M,u as I,j as t,B as w}from"./index-B4D4TeV5.js";import{aw as L,aH as l,S as b,T as _,I as D,B as E,bk as S}from"./antd-BreSrAtA.js";import{a as s}from"./react-UQ1dNgW8.js";import{F as R}from"./form-mode-context-D78nou8v.js";import"./faker-Dcf0Eyuj.js";var v=function(e){if(!e)return 0;var r=L(e).valueOf()-Date.now();return r<0?0:r},k=function(e){return{days:Math.floor(e/864e5),hours:Math.floor(e/36e5)%24,minutes:Math.floor(e/6e4)%60,seconds:Math.floor(e/1e3)%60,milliseconds:Math.floor(e)%1e3}},B=function(e){e===void 0&&(e={});var r=e||{},o=r.leftTime,c=r.targetDate,i=r.interval,u=i===void 0?1e3:i,a=r.onEnd,m=s.useMemo(function(){return T(o)&&o>0?Date.now()+o:void 0},[o]),n="leftTime"in e?m:c,x=F(s.useState(function(){return v(n)}),2),f=x[0],d=x[1],p=M(a);s.useEffect(function(){if(!n){d(0);return}d(v(n));var y=setInterval(function(){var h,g=v(n);d(g),g===0&&(clearInterval(y),(h=p.current)===null||h===void 0||h.call(p))},u);return function(){return clearInterval(y)}},[n,u]);var j=s.useMemo(function(){return k(f)},[f]);return[f,j]};const{Title:N}=_,P={email:""};function H(){const[e,r]=s.useState(0),[o]=B({targetDate:e,onEnd:()=>{r(0)}}),[c,i]=s.useState(!1),[u]=l.useForm(),{t:a}=I(),{setFormMode:m}=s.useContext(R),n=async()=>{i(!0),r(new Date().getTime()+1e3*30),setTimeout(()=>{i(!1)},1e3)};return t.jsxs(t.Fragment,{children:[t.jsxs(b,{direction:"vertical",children:[t.jsx(N,{level:3,children:a("authority.forgotPassword")}),t.jsx("p",{className:"text-xs opacity-80",children:a("authority.forgotPasswordSubtitle")})]}),t.jsxs(l,{name:"forgotForm",form:u,layout:"vertical",initialValues:P,onFinish:n,children:[t.jsx(l.Item,{label:a("authority.email"),name:"email",rules:[{required:!0},{type:"email",message:a("form.email.invalid")}],children:t.jsx(D,{placeholder:a("form.email.required")})}),t.jsx(l.Item,{children:t.jsx(E,{block:!0,type:"primary",htmlType:"submit",loading:c,disabled:o>0,children:o>0?a("authority.retryAfterText",{count:Math.floor(o/1e3)}):a("authority.sendResetLink")})}),t.jsx("div",{className:"text-sm text-center",children:t.jsx(w,{type:"link",icon:t.jsx(S,{}),className:"px-1",onPointerDown:()=>{m("login")},children:a("common.back")})})]})]})}export{H as ForgotPassword};
