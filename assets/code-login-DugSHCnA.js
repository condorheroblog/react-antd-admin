import{w as ye,g as ve,i as D,d as Y,e as R,f as oe,I as xe,h as je,k as be,m as we,j as n,u as z,B as M,n as Ee,o as Te,p as Pe}from"./index-CyuapfHA.js";import{g as Fe,r as u,R as Ne,l as ke,i as Ie,L as te}from"./react-BBS6oWoz.js";import{ac as Se,aq as P,ar as J,as as $e,at as A,au as _,B as q,av as re,aw as W,y as G,ax as ie,x as K,ay as Le,f as Ae}from"./antd-BzMpSgj2.js";import{c as _e}from"./index-DsoGgrUY.js";const Ce=!0;var Oe={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};const Me=Fe(Oe);var Re=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function ne(e){var r={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},t=e.match(/<\/?([^\s]+?)[/\s>]/);if(t&&(r.name=t[1],(Me[t[1]]||e.charAt(e.length-2)==="/")&&(r.voidElement=!0),r.name.startsWith("!--"))){var s=e.indexOf("-->");return{type:"comment",comment:s!==-1?e.slice(4,s):""}}for(var m=new RegExp(Re),a=null;(a=m.exec(e))!==null;)if(a[0].trim())if(a[1]){var o=a[1].trim(),d=[o,""];o.indexOf("=")>-1&&(d=o.split("=")),r.attrs[d[0]]=d[1],m.lastIndex--}else a[2]&&(r.attrs[a[2]]=a[3].trim().substring(1,a[3].length-1));return r}var De=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,qe=/^\s*$/,Ve=Object.create(null);function le(e,r){switch(r.type){case"text":return e+r.content;case"tag":return e+="<"+r.name+(r.attrs?function(t){var s=[];for(var m in t)s.push(m+'="'+t[m]+'"');return s.length?" "+s.join(" "):""}(r.attrs):"")+(r.voidElement?"/>":">"),r.voidElement?e:e+r.children.reduce(le,"")+"</"+r.name+">";case"comment":return e+"<!--"+r.comment+"-->"}}var Be={parse:function(e,r){r||(r={}),r.components||(r.components=Ve);var t,s=[],m=[],a=-1,o=!1;if(e.indexOf("<")!==0){var d=e.indexOf("<");s.push({type:"text",content:d===-1?e:e.substring(0,d)})}return e.replace(De,function(l,y){if(o){if(l!=="</"+t.name+">")return;o=!1}var h,f=l.charAt(1)!=="/",F=l.startsWith("<!--"),N=y+l.length,p=e.charAt(N);if(F){var w=ne(l);return a<0?(s.push(w),s):((h=m[a]).children.push(w),s)}if(f&&(a++,(t=ne(l)).type==="tag"&&r.components[t.name]&&(t.type="component",o=!0),t.voidElement||o||!p||p==="<"||t.children.push({type:"text",content:e.slice(N,e.indexOf("<",N))}),a===0&&s.push(t),(h=m[a-1])&&h.children.push(t),m[a]=t),(!f||t.voidElement)&&(a>-1&&(t.voidElement||t.name===l.slice(2,-1))&&(a--,t=a===-1?s:m[a]),!o&&p!=="<"&&p)){h=a===-1?s:m[a].children;var i=e.indexOf("<",N),v=e.slice(N,i===-1?void 0:i);qe.test(v)&&(v=" "),(i>-1&&a+h.length>=0||v!==" ")&&h.push({type:"text",content:v})}}),s},stringify:function(e){return e.reduce(function(r,t){return r+le("",t)},"")}};const Z=(e,r)=>{var s;if(!e)return!1;const t=((s=e.props)==null?void 0:s.children)??e.children;return r?t.length>0:!!t},Q=e=>{var t,s;if(!e)return[];const r=((t=e.props)==null?void 0:t.children)??e.children;return(s=e.props)!=null&&s.i18nIsDynamicList?O(r):r},He=e=>Array.isArray(e)&&e.every(u.isValidElement),O=e=>Array.isArray(e)?e:[e],Ue=(e,r)=>{const t={...r};return t.props=Object.assign(e.props,r.props),t},ce=(e,r)=>{if(!e)return"";let t="";const s=O(e),m=r!=null&&r.transSupportBasicHtmlNodes?r.transKeepBasicHtmlNodesFor??[]:[];return s.forEach((a,o)=>{if(D(a))t+=`${a}`;else if(u.isValidElement(a)){const{props:d,type:l}=a,y=Object.keys(d).length,h=m.indexOf(l)>-1,f=d.children;if(!f&&h&&!y)t+=`<${l}/>`;else if(!f&&(!h||y)||d.i18nIsDynamicList)t+=`<${o}></${o}>`;else if(h&&y===1&&D(f))t+=`<${l}>${f}</${l}>`;else{const F=ce(f,r);t+=`<${o}>${F}</${o}>`}}else if(a===null)Y("Trans: the passed in value is invalid - seems you passed in a null child.");else if(R(a)){const{format:d,...l}=a,y=Object.keys(l);if(y.length===1){const h=d?`${y[0]}, ${d}`:y[0];t+=`{{${h}}}`}else Y("react-i18next: the passed in object contained more than one variable - the object should look like {{ value, format }} where format is optional.",a)}else Y("Trans: the passed in value is invalid - seems you passed in a variable like {number} - please pass in variables for interpolation as full objects like {{number}}.",a)}),t},We=(e,r,t,s,m,a)=>{if(r==="")return[];const o=s.transKeepBasicHtmlNodesFor||[],d=r&&new RegExp(o.map(i=>`<${i}`).join("|")).test(r);if(!e&&!d&&!a)return[r];const l={},y=i=>{O(i).forEach(g=>{D(g)||(Z(g)?y(Q(g)):R(g)&&!u.isValidElement(g)&&Object.assign(l,g))})};y(e);const h=Be.parse(`<0>${r}</0>`),f={...l,...m},F=(i,v,g)=>{var x;const I=Q(i),L=p(I,v.children,g);return He(I)&&L.length===0||(x=i.props)!=null&&x.i18nIsDynamicList?I:L},N=(i,v,g,I,L)=>{i.dummy?(i.children=v,g.push(u.cloneElement(i,{key:I},L?void 0:v))):g.push(...u.Children.map([i],x=>{const c={...x.props};return delete c.i18nIsDynamicList,u.createElement(x.type,{...c,key:I,ref:x.ref},L?null:v)}))},p=(i,v,g)=>{const I=O(i);return O(v).reduce((x,c,E)=>{var $,T;const S=((T=($=c.children)==null?void 0:$[0])==null?void 0:T.content)&&t.services.interpolator.interpolate(c.children[0].content,f,t.language);if(c.type==="tag"){let b=I[parseInt(c.name,10)];g.length===1&&!b&&(b=g[0][c.name]),b||(b={});const k=Object.keys(c.attrs).length!==0?Ue({props:c.attrs},b):b,C=u.isValidElement(k),V=C&&Z(c,!0)&&!c.voidElement,B=d&&R(k)&&k.dummy&&!C,H=R(e)&&Object.hasOwnProperty.call(e,c.name);if(D(k)){const j=t.services.interpolator.interpolate(k,f,t.language);x.push(j)}else if(Z(k)||V){const j=F(k,c,g);N(k,j,x,E)}else if(B){const j=p(I,c.children,g);N(k,j,x,E)}else if(Number.isNaN(parseFloat(c.name)))if(H){const j=F(k,c,g);N(k,j,x,E,c.voidElement)}else if(s.transSupportBasicHtmlNodes&&o.indexOf(c.name)>-1)if(c.voidElement)x.push(u.createElement(c.name,{key:`${c.name}-${E}`}));else{const j=p(I,c.children,g);x.push(u.createElement(c.name,{key:`${c.name}-${E}`},j))}else if(c.voidElement)x.push(`<${c.name} />`);else{const j=p(I,c.children,g);x.push(`<${c.name}>${j}</${c.name}>`)}else if(R(k)&&!C){const j=c.children[0]?S:null;j&&x.push(j)}else N(k,S,x,E,c.children.length!==1||!S)}else if(c.type==="text"){const b=s.transWrapTextNodes,k=a?s.unescape(t.services.interpolator.interpolate(c.content,f,t.language)):t.services.interpolator.interpolate(c.content,f,t.language);b?x.push(u.createElement(b,{key:`${c.name}-${E}`},k)):x.push(k)}return x},[])},w=p([{dummy:!0,children:e||[]}],h,O(e||[]));return Q(w[0])};function ze({children:e,count:r,parent:t,i18nKey:s,context:m,tOptions:a={},values:o,defaults:d,components:l,ns:y,i18n:h,t:f,shouldUnescape:F,...N}){var b,k,C,V,B,H;const p=h||oe();if(!p)return ye("You will need to pass in an i18next instance by using i18nextReactModule"),e;const w=f||p.t.bind(p)||(j=>j),i={...ve(),...(b=p.options)==null?void 0:b.react};let v=y||w.ns||((k=p.options)==null?void 0:k.defaultNS);v=D(v)?[v]:v||["translation"];const g=ce(e,i),I=d||g||i.transEmptyNodeValue||s,{hashTransKey:L}=i,x=s||(L?L(g||I):g||I);(V=(C=p.options)==null?void 0:C.interpolation)!=null&&V.defaultVariables&&(o=o&&Object.keys(o).length>0?{...o,...p.options.interpolation.defaultVariables}:{...p.options.interpolation.defaultVariables});const c=o||r!==void 0&&!((H=(B=p.options)==null?void 0:B.interpolation)!=null&&H.alwaysFormat)||!e?a.interpolation:{interpolation:{...a.interpolation,prefix:"#$?",suffix:"?$#"}},E={...a,context:m||a.context,count:r,...o,...c,defaultValue:I,ns:v},S=x?w(x,E):I;l&&Object.keys(l).forEach(j=>{l[j].key||(l[j]=u.cloneElement(l[j],{key:j}));const U=l[j];if(typeof U.type=="function"||!U.props||!U.props.children||S.indexOf(`${j}/>`)<0&&S.indexOf(`${j} />`)<0)return;function ge(){return u.createElement(u.Fragment,null,U)}l[j]=u.createElement(ge)});const $=We(l||e,S,p,i,E,F),T=t??i.defaultTransParent;return T?u.createElement(T,N,$):$}function Ge({children:e,count:r,parent:t,i18nKey:s,context:m,tOptions:a={},values:o,defaults:d,components:l,ns:y,i18n:h,t:f,shouldUnescape:F,...N}){var g;const{i18n:p,defaultNS:w}=u.useContext(xe)||{},i=h||p||oe(),v=f||(i==null?void 0:i.t.bind(i));return ze({children:e,count:r,parent:t,i18nKey:s,context:m,tOptions:a,values:o,defaults:d,components:l,ns:y||(v==null?void 0:v.ns)||w||((g=i==null?void 0:i.options)==null?void 0:g.defaultNS),i18n:i,t:f,shouldUnescape:F,...N})}var ee=function(e){if(!e)return 0;var r=Se(e).valueOf()-Date.now();return r<0?0:r},Ke=function(e){return{days:Math.floor(e/864e5),hours:Math.floor(e/36e5)%24,minutes:Math.floor(e/6e4)%60,seconds:Math.floor(e/1e3)%60,milliseconds:Math.floor(e)%1e3}},Xe=function(e){e===void 0&&(e={});var r=e||{},t=r.leftTime,s=r.targetDate,m=r.interval,a=m===void 0?1e3:m,o=r.onEnd,d=u.useMemo(function(){return je(t)&&t>0?Date.now()+t:void 0},[t]),l="leftTime"in e?d:s,y=be(u.useState(function(){return ee(l)}),2),h=y[0],f=y[1],F=we(o);u.useEffect(function(){if(!l){f(0);return}f(ee(l));var p=setInterval(function(){var w,i=ee(l);f(i),i===0&&(clearInterval(p),(w=F.current)===null||w===void 0||w.call(F))},a);return function(){return clearInterval(p)}},[l,a]);var N=u.useMemo(function(){return Ke(h)},[h]);return[h,N]},Ye=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],Je=Ne.forwardRef(function(e,r){var t=P.useFormInstance(),s=u.useState(e.countDown||60),m=J(s,2),a=m[0],o=m[1],d=u.useState(!1),l=J(d,2),y=l[0],h=l[1],f=u.useState(),F=J(f,2),N=F[0],p=F[1];e.rules,e.name;var w=e.phoneName,i=e.fieldProps,v=e.onTiming,g=e.captchaTextRender,I=g===void 0?function(E,S){return E?"".concat(S," 秒后重新获取"):"获取验证码"}:g,L=e.captchaProps,x=$e(e,Ye),c=function(){var E=re(W().mark(function S($){return W().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,p(!0),b.next=4,x.onGetCaptcha($);case 4:p(!1),h(!0),b.next=13;break;case 8:b.prev=8,b.t0=b.catch(0),h(!1),p(!1),console.log(b.t0);case 13:case"end":return b.stop()}},S,null,[[0,8]])}));return function($){return E.apply(this,arguments)}}();return u.useImperativeHandle(r,function(){return{startTiming:function(){return h(!0)},endTiming:function(){return h(!1)}}}),u.useEffect(function(){var E=0,S=e.countDown;return y&&(E=window.setInterval(function(){o(function($){return $<=1?(h(!1),clearInterval(E),S||60):$-1})},1e3)),function(){return clearInterval(E)}},[y]),u.useEffect(function(){v&&v(a)},[a,v]),n.jsxs("div",{style:A(A({},i==null?void 0:i.style),{},{display:"flex",alignItems:"center"}),ref:r,children:[n.jsx(_,A(A({},i),{},{style:A({flex:1,transition:"width .3s",marginRight:8},i==null?void 0:i.style)})),n.jsx(q,A(A({style:{display:"block"},disabled:y,loading:N},L),{},{onClick:re(W().mark(function E(){var S;return W().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(T.prev=0,!w){T.next=9;break}return T.next=4,t.validateFields([w].flat(1));case 4:return S=t.getFieldValue([w].flat(1)),T.next=7,c(S);case 7:T.next=11;break;case 9:return T.next=11,c("");case 11:T.next=16;break;case 13:T.prev=13,T.t0=T.catch(0),console.log(T.t0);case 16:case"end":return T.stop()}},E,null,[[0,13]])})),children:I(y,a)}))]})}),Ze=_e(Je);const Qe=/^[\w-]{4,16}$/,et=/^(?:(?:\+|00)86)?1\d{10}$/;function ue(e){return[{required:!0,message:e("form.username.required")},{pattern:Qe,message:e("form.username.invalid")}]}function me(e){return[{required:!0,message:e("form.password.required")},{pattern:/^(?=.*\d)(?=.*[a-z])[\w~!@#$%^&*+.\-]{8,16}$/i,message:e("form.password.invalid")}]}function tt(e){return[{required:!0,message:e("form.mobile.required")},{pattern:et,message:e("form.mobile.invalid")}]}const{Title:rt}=K,nt={email:""};function de(){const[e,r]=u.useState(0),[t]=Xe({targetDate:e,onEnd:()=>{r(0)}}),[s,m]=u.useState(!1),[a]=P.useForm(),{t:o}=z(),{setFormMode:d}=u.useContext(X),l=async()=>{m(!0),r(new Date().getTime()+1e3*30),setTimeout(()=>{m(!1)},1e3)};return n.jsxs(n.Fragment,{children:[n.jsxs(G,{direction:"vertical",children:[n.jsx(rt,{level:3,children:o("authority.forgotPassword")}),n.jsx("p",{className:"text-xs opacity-80",children:o("authority.forgotPasswordSubtitle")})]}),n.jsxs(P,{name:"forgotForm",form:a,layout:"vertical",initialValues:nt,onFinish:l,children:[n.jsx(P.Item,{label:o("authority.email"),name:"email",rules:[{required:!0},{type:"email",message:o("form.email.invalid")}],children:n.jsx(_,{placeholder:o("form.email.required")})}),n.jsx(P.Item,{children:n.jsx(q,{block:!0,type:"primary",htmlType:"submit",loading:s,disabled:t>0,children:t>0?o("authority.retryAfterText",{count:Math.floor(t/1e3)}):o("authority.sendResetLink")})}),n.jsx("div",{className:"text-sm text-center",children:n.jsx(M,{type:"link",icon:n.jsx(ie,{}),className:"px-1",onPointerDown:()=>{d("login")},children:o("common.back")})})]})]})}const dt=Object.freeze(Object.defineProperty({__proto__:null,ForgotPassword:de},Symbol.toStringTag,{value:"Module"})),{Title:se}=K,st={username:"admin",password:"123456789admin"};function fe(){const[e,r]=u.useState(!1),[t]=P.useForm(),{t:s}=z(),[m]=ke(),a=Ie(),o=Ee(f=>f.login),d=Te(f=>f.handleAsyncRoutes),l=Pe(f=>f.getUserInfo),{setFormMode:y}=u.useContext(X),h=async f=>{r(!0);try{await o(f);const F=[];if(F.push(l()),Ce&&F.push(d()),(await Promise.allSettled(F)).some(w=>w.status==="rejected"))a("/error/500");else{const w=m.get("redirect");a(w?`/${w.slice(1)}`:"/")}}finally{r(!1)}};return n.jsxs(n.Fragment,{children:[n.jsxs(G,{direction:"vertical",children:[n.jsx(se,{level:3,children:"Hello, Welcome to"}),n.jsx(se,{className:"mt-0",level:5,children:"React Antd Admin"})]}),n.jsxs(P,{name:"passwordLoginForm",form:t,layout:"vertical",initialValues:st,onFinish:h,children:[n.jsx(P.Item,{label:s("authority.username"),name:"username",rules:ue(s),children:n.jsx(_,{placeholder:s("form.username.required")})}),n.jsx(P.Item,{label:s("authority.password"),name:"password",rules:me(s),children:n.jsx(_.Password,{placeholder:s("form.password.required")})}),n.jsxs(P.Item,{children:[n.jsxs("div",{className:"flex justify-between mb-5 -mt-1 text-sm",children:[n.jsx(M,{type:"link",className:"p-0",onPointerDown:()=>{y("codeLogin")},children:s("authority.codeLogin")}),n.jsx(M,{type:"link",className:"p-0",onPointerDown:()=>{y("forgotPassword")},children:s("authority.forgotPassword")})]}),n.jsx(q,{block:!0,type:"primary",htmlType:"submit",loading:e,children:s("authority.login")})]}),n.jsxs("div",{className:"text-sm text-center",children:[s("authority.noAccountYet"),n.jsx(M,{type:"link",className:"px-1",onPointerDown:()=>{y("register")},children:s("authority.goToRegister")})]})]})]})}const ft=Object.freeze(Object.defineProperty({__proto__:null,PasswordLogin:fe},Symbol.toStringTag,{value:"Module"})),{Title:ae}=K,at={username:"",password:"",confirmPassword:""};function pe(){const[e]=u.useState(!1),[r]=P.useForm(),{t}=z(),{setFormMode:s}=u.useContext(X),m=async()=>{var a;(a=window.$message)==null||a.success("注册成功")};return n.jsxs(n.Fragment,{children:[n.jsxs(G,{direction:"vertical",children:[n.jsx(ae,{level:3,children:"Hello, Welcome to"}),n.jsx(ae,{className:"mt-0",level:5,children:"React Antd Admin"})]}),n.jsxs(P,{name:"registerForm",form:r,layout:"vertical",initialValues:at,onFinish:m,children:[n.jsx(P.Item,{label:t("authority.username"),name:"username",rules:ue(t),children:n.jsx(_,{placeholder:t("form.username.required")})}),n.jsx(P.Item,{label:t("authority.password"),name:"password",rules:me(t),children:n.jsx(_.Password,{placeholder:t("form.password.required")})}),n.jsx(P.Item,{name:"confirm",label:t("authority.confirmPassword"),dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:t("form.confirmPassword.required")},({getFieldValue:a})=>({validator(o,d){return!d||a("password")===d?Promise.resolve():Promise.reject(new Error(t("form.confirmPassword.invalid")))}})],children:n.jsx(_.Password,{placeholder:t("form.confirmPassword.required")})}),n.jsx(P.Item,{rules:[()=>({validator(a,o){return o!==!0?Promise.reject(new Error(t("form.agree.required"))):Promise.resolve()}})],name:"termsAgreement",valuePropName:"checked",children:n.jsx(Le,{children:n.jsx("div",{className:"flex flex-wrap text-xs",children:n.jsx(Ge,{i18nKey:"authority.agree",components:[n.jsx(te,{to:"/terms-of-service",target:"_blank"},0),n.jsx(te,{to:"/privacy-policy",target:"_blank"},1)]})})})}),n.jsx(P.Item,{children:n.jsx(q,{block:!0,type:"primary",htmlType:"submit",loading:e,children:t("authority.register")})}),n.jsxs("div",{className:"text-sm text-center",children:[t("authority.alreadyHaveAnAccount"),n.jsx(M,{type:"link",className:"px-1",onPointerDown:()=>{s("login")},children:t("authority.goToLogin")})]})]})]})}const pt=Object.freeze(Object.defineProperty({__proto__:null,RegisterPassword:pe},Symbol.toStringTag,{value:"Module"})),ht={login:u.createElement(fe),register:u.createElement(pe),forgotPassword:u.createElement(de),codeLogin:u.createElement(he)},X=u.createContext({formMode:"login",setFormMode:()=>{}}),{Title:ot}=K,it={phoneNumber:"",captcha:""};function he(){const[e,r]=u.useState(!1),[t]=P.useForm(),{t:s}=z(),{setFormMode:m}=u.useContext(X),a=async()=>{r(!0),setTimeout(()=>{var o;r(!1),(o=window.$message)==null||o.success(s("common.success"))},1e3)};return n.jsxs(n.Fragment,{children:[n.jsx(G,{direction:"vertical",children:n.jsx(ot,{level:3,children:s("authority.codeLogin")})}),n.jsxs(P,{name:"codeLoginForm",form:t,layout:"vertical",initialValues:it,onFinish:a,children:[n.jsx(P.Item,{label:s("authority.mobile"),name:"phoneNumber",rules:tt(s),children:n.jsx(Ae,{controls:!1,className:"w-full",placeholder:s("form.mobile.required")})}),n.jsx(Ze,{label:s("authority.code"),placeholder:s("form.code.required"),captchaTextRender:(o,d)=>o?s("authority.sendText",{second:d}):s("authority.sendCode"),onGetCaptcha:()=>{var o;return(o=window.$message)==null||o.success(s("common.success")),Promise.resolve()},rules:[{required:!0}],phoneName:"phoneNumber",name:"captcha"}),n.jsx(P.Item,{children:n.jsx(q,{block:!0,type:"primary",htmlType:"submit",loading:e,children:s("authority.login")})}),n.jsx("div",{className:"text-sm text-center",children:n.jsx(M,{type:"link",icon:n.jsx(ie,{}),className:"px-1",onPointerDown:()=>{m("login")},children:s("common.back")})})]})]})}const gt=Object.freeze(Object.defineProperty({__proto__:null,CodeLogin:he},Symbol.toStringTag,{value:"Module"}));export{X as F,ht as a,gt as c,dt as f,ft as p,pt as r};
