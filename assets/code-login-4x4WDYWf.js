import{w as oe,p as ie,q as ve,s as D,t as X,v as O,I as je,x as be,y as we,z as Ee,j as s,u as U,B as R,b as Te}from"./index-Cu2kO6lS.js";import{g as Ne,a as u,R as Pe,i as Ie,f as Fe,L as te}from"./react-B2eEhSVY.js";import{al as Se,az as N,aA as J,aB as ke,aC as A,ad as C,k as V,aD as re,aE as z,z as W,T as ee,aF as le,s as _e,ae as $e,j as Ae}from"./antd-bHmztw5J.js";import{c as Ce}from"./index-BSdwXTWa.js";var Y,ne;function Le(){return ne||(ne=1,Y={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Y}var Oe=Le();const Me=Ne(Oe);var Re=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function se(e){var n={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},t=e.match(/<\/?([^\s]+?)[/\s>]/);if(t&&(n.name=t[1],(Me[t[1]]||e.charAt(e.length-2)==="/")&&(n.voidElement=!0),n.name.startsWith("!--"))){var r=e.indexOf("-->");return{type:"comment",comment:r!==-1?e.slice(4,r):""}}for(var o=new RegExp(Re),a=null;(a=o.exec(e))!==null;)if(a[0].trim())if(a[1]){var i=a[1].trim(),m=[i,""];i.indexOf("=")>-1&&(m=i.split("=")),n.attrs[m[0]]=m[1],o.lastIndex--}else a[2]&&(n.attrs[a[2]]=a[3].trim().substring(1,a[3].length-1));return n}var De=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,Ve=/^\s*$/,qe=Object.create(null);function ce(e,n){switch(n.type){case"text":return e+n.content;case"tag":return e+="<"+n.name+(n.attrs?function(t){var r=[];for(var o in t)r.push(o+'="'+t[o]+'"');return r.length?" "+r.join(" "):""}(n.attrs):"")+(n.voidElement?"/>":">"),n.voidElement?e:e+n.children.reduce(ce,"")+"</"+n.name+">";case"comment":return e+"<!--"+n.comment+"-->"}}var Be={parse:function(e,n){n||(n={}),n.components||(n.components=qe);var t,r=[],o=[],a=-1,i=!1;if(e.indexOf("<")!==0){var m=e.indexOf("<");r.push({type:"text",content:m===-1?e:e.substring(0,m)})}return e.replace(De,function(f,y){if(i){if(f!=="</"+t.name+">")return;i=!1}var p,h=f.charAt(1)!=="/",j=f.startsWith("<!--"),x=y+f.length,d=e.charAt(x);if(j){var F=se(f);return a<0?(r.push(F),r):((p=o[a]).children.push(F),r)}if(h&&(a++,(t=se(f)).type==="tag"&&n.components[t.name]&&(t.type="component",i=!0),t.voidElement||i||!d||d==="<"||t.children.push({type:"text",content:e.slice(x,e.indexOf("<",x))}),a===0&&r.push(t),(p=o[a-1])&&p.children.push(t),o[a]=t),(!h||t.voidElement)&&(a>-1&&(t.voidElement||t.name===f.slice(2,-1))&&(a--,t=a===-1?r:o[a]),!i&&d!=="<"&&d)){p=a===-1?r:o[a].children;var l=e.indexOf("<",x),v=e.slice(x,l===-1?void 0:l);Ve.test(v)&&(v=" "),(l>-1&&a+p.length>=0||v!==" ")&&p.push({type:"text",content:v})}}),r},stringify:function(e){return e.reduce(function(n,t){return n+ce("",t)},"")}};const Z=(e,n)=>{var r;if(!e)return!1;const t=((r=e.props)==null?void 0:r.children)??e.children;return n?t.length>0:!!t},K=e=>{var t,r;if(!e)return[];const n=((t=e.props)==null?void 0:t.children)??e.children;return(r=e.props)!=null&&r.i18nIsDynamicList?M(n):n},He=e=>Array.isArray(e)&&e.every(u.isValidElement),M=e=>Array.isArray(e)?e:[e],ze=(e,n)=>{const t={...n};return t.props=Object.assign(e.props,n.props),t},ue=(e,n,t,r)=>{if(!e)return"";let o="";const a=M(e),i=n!=null&&n.transSupportBasicHtmlNodes?n.transKeepBasicHtmlNodesFor??[]:[];return a.forEach((m,f)=>{if(D(m)){o+=`${m}`;return}if(u.isValidElement(m)){const{props:y,type:p}=m,h=Object.keys(y).length,j=i.indexOf(p)>-1,x=y.children;if(!x&&j&&!h){o+=`<${p}/>`;return}if(!x&&(!j||h)||y.i18nIsDynamicList){o+=`<${f}></${f}>`;return}if(j&&h===1&&D(x)){o+=`<${p}>${x}</${p}>`;return}const d=ue(x,n,t,r);o+=`<${f}>${d}</${f}>`;return}if(m===null){X(t,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:r});return}if(O(m)){const{format:y,...p}=m,h=Object.keys(p);if(h.length===1){const j=y?`${h[0]}, ${y}`:h[0];o+=`{{${j}}}`;return}X(t,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:r,child:m});return}X(t,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:r,child:m})}),o},Ue=(e,n,t,r,o,a)=>{if(n==="")return[];const i=r.transKeepBasicHtmlNodesFor||[],m=n&&new RegExp(i.map(l=>`<${l}`).join("|")).test(n);if(!e&&!m&&!a)return[n];const f={},y=l=>{M(l).forEach(g=>{D(g)||(Z(g)?y(K(g)):O(g)&&!u.isValidElement(g)&&Object.assign(f,g))})};y(e);const p=Be.parse(`<0>${n}</0>`),h={...f,...o},j=(l,v,g)=>{var b;const I=K(l),_=d(I,v.children,g);return He(I)&&_.length===0||(b=l.props)!=null&&b.i18nIsDynamicList?I:_},x=(l,v,g,I,_)=>{l.dummy?(l.children=v,g.push(u.cloneElement(l,{key:I},_?void 0:v))):g.push(...u.Children.map([l],b=>{const c={...b.props};return delete c.i18nIsDynamicList,u.createElement(b.type,{...c,key:I,ref:b.ref},_?null:v)}))},d=(l,v,g)=>{const I=M(l);return M(v).reduce((b,c,E)=>{var $,T;const k=((T=($=c.children)==null?void 0:$[0])==null?void 0:T.content)&&t.services.interpolator.interpolate(c.children[0].content,h,t.language);if(c.type==="tag"){let w=I[parseInt(c.name,10)];g.length===1&&!w&&(w=g[0][c.name]),w||(w={});const P=Object.keys(c.attrs).length!==0?ze({props:c.attrs},w):w,L=u.isValidElement(P),q=L&&Z(c,!0)&&!c.voidElement,B=m&&O(P)&&P.dummy&&!L,H=O(e)&&Object.hasOwnProperty.call(e,c.name);if(D(P)){const S=t.services.interpolator.interpolate(P,h,t.language);b.push(S)}else if(Z(P)||q){const S=j(P,c,g);x(P,S,b,E)}else if(B){const S=d(I,c.children,g);x(P,S,b,E)}else if(Number.isNaN(parseFloat(c.name)))if(H){const S=j(P,c,g);x(P,S,b,E,c.voidElement)}else if(r.transSupportBasicHtmlNodes&&i.indexOf(c.name)>-1)if(c.voidElement)b.push(u.createElement(c.name,{key:`${c.name}-${E}`}));else{const S=d(I,c.children,g);b.push(u.createElement(c.name,{key:`${c.name}-${E}`},S))}else if(c.voidElement)b.push(`<${c.name} />`);else{const S=d(I,c.children,g);b.push(`<${c.name}>${S}</${c.name}>`)}else if(O(P)&&!L){const S=c.children[0]?k:null;S&&b.push(S)}else x(P,k,b,E,c.children.length!==1||!k)}else if(c.type==="text"){const w=r.transWrapTextNodes,P=a?r.unescape(t.services.interpolator.interpolate(c.content,h,t.language)):t.services.interpolator.interpolate(c.content,h,t.language);w?b.push(u.createElement(w,{key:`${c.name}-${E}`},P)):b.push(P)}return b},[])},F=d([{dummy:!0,children:e||[]}],p,M(e||[]));return K(F[0])},me=(e,n,t)=>{const r=e.key||n,o=u.cloneElement(e,{key:r});if(!o.props||!o.props.children||t.indexOf(`${n}/>`)<0&&t.indexOf(`${n} />`)<0)return o;function a(){return u.createElement(u.Fragment,null,o)}return u.createElement(a,{key:r})},We=(e,n)=>e.map((t,r)=>me(t,r,n)),Ge=(e,n)=>{const t={};return Object.keys(e).forEach(r=>{Object.assign(t,{[r]:me(e[r],r,n)})}),t},Xe=(e,n,t,r)=>e?Array.isArray(e)?We(e,n):O(e)?Ge(e,n):(oe(t,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:r}),null):null;function Je({children:e,count:n,parent:t,i18nKey:r,context:o,tOptions:a={},values:i,defaults:m,components:f,ns:y,i18n:p,t:h,shouldUnescape:j,...x}){var P,L,q,B,H,S;const d=p||ie();if(!d)return oe(d,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:r}),e;const F=h||d.t.bind(d)||(xe=>xe),l={...ve(),...(P=d.options)==null?void 0:P.react};let v=y||F.ns||((L=d.options)==null?void 0:L.defaultNS);v=D(v)?[v]:v||["translation"];const g=ue(e,l,d,r),I=m||g||l.transEmptyNodeValue||r,{hashTransKey:_}=l,b=r||(_?_(g||I):g||I);(B=(q=d.options)==null?void 0:q.interpolation)!=null&&B.defaultVariables&&(i=i&&Object.keys(i).length>0?{...i,...d.options.interpolation.defaultVariables}:{...d.options.interpolation.defaultVariables});const c=i||n!==void 0&&!((S=(H=d.options)==null?void 0:H.interpolation)!=null&&S.alwaysFormat)||!e?a.interpolation:{interpolation:{...a.interpolation,prefix:"#$?",suffix:"?$#"}},E={...a,context:o||a.context,count:n,...i,...c,defaultValue:I,ns:v},k=b?F(b,E):I,$=Xe(f,k,d,r),T=Ue($||e,k,d,l,E,j),w=t??l.defaultTransParent;return w?u.createElement(w,x,T):T}function Ye({children:e,count:n,parent:t,i18nKey:r,context:o,tOptions:a={},values:i,defaults:m,components:f,ns:y,i18n:p,t:h,shouldUnescape:j,...x}){var g;const{i18n:d,defaultNS:F}=u.useContext(je)||{},l=p||d||ie(),v=h||(l==null?void 0:l.t.bind(l));return Je({children:e,count:n,parent:t,i18nKey:r,context:o,tOptions:a,values:i,defaults:m,components:f,ns:y||(v==null?void 0:v.ns)||F||((g=l==null?void 0:l.options)==null?void 0:g.defaultNS),i18n:l,t:h,shouldUnescape:j,...x})}var Q=function(e){if(!e)return 0;var n=Se(e).valueOf()-Date.now();return n<0?0:n},Ze=function(e){return{days:Math.floor(e/864e5),hours:Math.floor(e/36e5)%24,minutes:Math.floor(e/6e4)%60,seconds:Math.floor(e/1e3)%60,milliseconds:Math.floor(e)%1e3}},Ke=function(e){e===void 0&&(e={});var n=e||{},t=n.leftTime,r=n.targetDate,o=n.interval,a=o===void 0?1e3:o,i=n.onEnd,m=u.useMemo(function(){return be(t)&&t>0?Date.now()+t:void 0},[t]),f="leftTime"in e?m:r,y=we(u.useState(function(){return Q(f)}),2),p=y[0],h=y[1],j=Ee(i);u.useEffect(function(){if(!f){h(0);return}h(Q(f));var d=setInterval(function(){var F,l=Q(f);h(l),l===0&&(clearInterval(d),(F=j.current)===null||F===void 0||F.call(j))},a);return function(){return clearInterval(d)}},[f,a]);var x=u.useMemo(function(){return Ze(p)},[p]);return[p,x]},Qe=["rules","name","phoneName","fieldProps","onTiming","captchaTextRender","captchaProps"],et=Pe.forwardRef(function(e,n){var t=N.useFormInstance(),r=u.useState(e.countDown||60),o=J(r,2),a=o[0],i=o[1],m=u.useState(!1),f=J(m,2),y=f[0],p=f[1],h=u.useState(),j=J(h,2),x=j[0],d=j[1];e.rules,e.name;var F=e.phoneName,l=e.fieldProps,v=e.onTiming,g=e.captchaTextRender,I=g===void 0?function(E,k){return E?"".concat(k," 秒后重新获取"):"获取验证码"}:g,_=e.captchaProps,b=ke(e,Qe),c=function(){var E=re(z().mark(function k($){return z().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.prev=0,d(!0),w.next=4,b.onGetCaptcha($);case 4:d(!1),p(!0),w.next=13;break;case 8:w.prev=8,w.t0=w.catch(0),p(!1),d(!1),console.log(w.t0);case 13:case"end":return w.stop()}},k,null,[[0,8]])}));return function($){return E.apply(this,arguments)}}();return u.useImperativeHandle(n,function(){return{startTiming:function(){return p(!0)},endTiming:function(){return p(!1)}}}),u.useEffect(function(){var E=0,k=e.countDown;return y&&(E=window.setInterval(function(){i(function($){return $<=1?(p(!1),clearInterval(E),k||60):$-1})},1e3)),function(){return clearInterval(E)}},[y]),u.useEffect(function(){v&&v(a)},[a,v]),s.jsxs("div",{style:A(A({},l==null?void 0:l.style),{},{display:"flex",alignItems:"center"}),ref:n,children:[s.jsx(C,A(A({},l),{},{style:A({flex:1,transition:"width .3s",marginRight:8},l==null?void 0:l.style)})),s.jsx(V,A(A({style:{display:"block"},disabled:y,loading:x},_),{},{onClick:re(z().mark(function E(){var k;return z().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(T.prev=0,!F){T.next=9;break}return T.next=4,t.validateFields([F].flat(1));case 4:return k=t.getFieldValue([F].flat(1)),T.next=7,c(k);case 7:T.next=11;break;case 9:return T.next=11,c("");case 11:T.next=16;break;case 13:T.prev=13,T.t0=T.catch(0),console.log(T.t0);case 16:case"end":return T.stop()}},E,null,[[0,13]])})),children:I(y,a)}))]})}),tt=Ce(et);const rt=/^[\w-]{4,16}$/,nt=/^(?:(?:\+|00)86)?1\d{10}$/;function de(e){return[{required:!0,message:e("form.username.required")},{pattern:rt,message:e("form.username.invalid")}]}function fe(e){return[{required:!0,message:e("form.password.required")},{pattern:/^(?=.*\d)(?=.*[a-z])[\w~!@#$%^&*+.\-]{8,16}$/i,message:e("form.password.invalid")}]}function st(e){return[{required:!0,message:e("form.mobile.required")},{pattern:nt,message:e("form.mobile.invalid")}]}const{Title:at}=ee,ot={email:""};function pe(){const[e,n]=u.useState(0),[t]=Ke({targetDate:e,onEnd:()=>{n(0)}}),[r,o]=u.useState(!1),[a]=N.useForm(),{t:i}=U(),{setFormMode:m}=u.useContext(G),f=async()=>{o(!0),n(new Date().getTime()+1e3*30),setTimeout(()=>{o(!1)},1e3)};return s.jsxs(s.Fragment,{children:[s.jsxs(W,{direction:"vertical",children:[s.jsx(at,{level:3,children:i("authority.forgotPassword")}),s.jsx("p",{className:"text-xs opacity-80",children:i("authority.forgotPasswordSubtitle")})]}),s.jsxs(N,{name:"forgotForm",form:a,layout:"vertical",initialValues:ot,onFinish:f,children:[s.jsx(N.Item,{label:i("authority.email"),name:"email",rules:[{required:!0},{type:"email",message:i("form.email.invalid")}],children:s.jsx(C,{placeholder:i("form.email.required")})}),s.jsx(N.Item,{children:s.jsx(V,{block:!0,type:"primary",htmlType:"submit",loading:r,disabled:t>0,children:t>0?i("authority.retryAfterText",{count:Math.floor(t/1e3)}):i("authority.sendResetLink")})}),s.jsx("div",{className:"text-sm text-center",children:s.jsx(R,{type:"link",icon:s.jsx(le,{}),className:"px-1",onPointerDown:()=>{m("login")},children:i("common.back")})})]})]})}const ht=Object.freeze(Object.defineProperty({__proto__:null,ForgotPassword:pe},Symbol.toStringTag,{value:"Module"})),it={username:"admin",password:"123456789admin"};function he(){const[e,n]=u.useState(!1),[t]=N.useForm(),{t:r}=U(),[o,a]=_e.useMessage(),[i]=Ie(),m=Fe(),f=Te(h=>h.login),{setFormMode:y}=u.useContext(G),p=async h=>{n(!0),o==null||o.loading(r("authority.loginInProgress"),0),f(h).then(()=>{var x;o==null||o.destroy(),(x=window.$message)==null||x.success(r("authority.loginSuccess"));const j=i.get("redirect");m(j?`/${j.slice(1)}`:"/home")}).finally(()=>{o==null||o.destroy(),setTimeout(()=>{var j;(j=window.$message)==null||j.destroy(),n(!1)},1e3)})};return s.jsxs(s.Fragment,{children:[a,s.jsxs(W,{direction:"vertical",children:[s.jsxs("h2",{className:"text-colorText mb-3 text-3xl font-bold leading-9 tracking-tight lg:text-4xl",children:[r("authority.welcomeBack")," ","  👏"]}),s.jsx("p",{className:"lg:text-base text-sm text-colorTextSecondary",children:r("authority.loginDescription")})]}),s.jsxs(N,{name:"passwordLoginForm",form:t,layout:"vertical",initialValues:it,onFinish:p,children:[s.jsx(N.Item,{label:r("authority.username"),name:"username",rules:de(r),children:s.jsx(C,{placeholder:r("form.username.required")})}),s.jsx(N.Item,{label:r("authority.password"),name:"password",rules:fe(r),children:s.jsx(C.Password,{placeholder:r("form.password.required")})}),s.jsxs(N.Item,{children:[s.jsxs("div",{className:"flex justify-between mb-5 -mt-1 text-sm",children:[s.jsx(R,{type:"link",className:"p-0",onPointerDown:()=>{y("codeLogin")},children:r("authority.codeLogin")}),s.jsx(R,{type:"link",className:"p-0",onPointerDown:()=>{y("forgotPassword")},children:r("authority.forgotPassword")})]}),s.jsx(V,{block:!0,type:"primary",htmlType:"submit",loading:e,children:r("authority.login")})]}),s.jsxs("div",{className:"text-sm text-center",children:[r("authority.noAccountYet"),s.jsx(R,{type:"link",className:"px-1",onPointerDown:()=>{y("register")},children:r("authority.goToRegister")})]})]})]})}const gt=Object.freeze(Object.defineProperty({__proto__:null,PasswordLogin:he},Symbol.toStringTag,{value:"Module"})),{Title:ae}=ee,lt={username:"",password:"",confirmPassword:""};function ge(){const[e]=u.useState(!1),[n]=N.useForm(),{t}=U(),{setFormMode:r}=u.useContext(G),o=async()=>{var a;(a=window.$message)==null||a.success("注册成功")};return s.jsxs(s.Fragment,{children:[s.jsxs(W,{direction:"vertical",children:[s.jsx(ae,{level:3,children:"Hello, Welcome to"}),s.jsx(ae,{className:"mt-0",level:5,children:"React Antd Admin"})]}),s.jsxs(N,{name:"registerForm",form:n,layout:"vertical",initialValues:lt,onFinish:o,children:[s.jsx(N.Item,{label:t("authority.username"),name:"username",rules:de(t),children:s.jsx(C,{placeholder:t("form.username.required")})}),s.jsx(N.Item,{label:t("authority.password"),name:"password",rules:fe(t),children:s.jsx(C.Password,{placeholder:t("form.password.required")})}),s.jsx(N.Item,{name:"confirm",label:t("authority.confirmPassword"),dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:t("form.confirmPassword.required")},({getFieldValue:a})=>({validator(i,m){return!m||a("password")===m?Promise.resolve():Promise.reject(new Error(t("form.confirmPassword.invalid")))}})],children:s.jsx(C.Password,{placeholder:t("form.confirmPassword.required")})}),s.jsx(N.Item,{rules:[()=>({validator(a,i){return i!==!0?Promise.reject(new Error(t("form.agree.required"))):Promise.resolve()}})],name:"termsAgreement",valuePropName:"checked",children:s.jsx($e,{children:s.jsx("div",{className:"flex flex-wrap text-xs",children:s.jsx(Ye,{i18nKey:"authority.agree",components:[s.jsx(te,{to:"/terms-of-service",target:"_blank"},0),s.jsx(te,{to:"/privacy-policy",target:"_blank"},1)]})})})}),s.jsx(N.Item,{children:s.jsx(V,{block:!0,type:"primary",htmlType:"submit",loading:e,children:t("authority.register")})}),s.jsxs("div",{className:"text-sm text-center",children:[t("authority.alreadyHaveAnAccount"),s.jsx(R,{type:"link",className:"px-1",onPointerDown:()=>{r("login")},children:t("authority.goToLogin")})]})]})]})}const yt=Object.freeze(Object.defineProperty({__proto__:null,RegisterPassword:ge},Symbol.toStringTag,{value:"Module"})),xt={login:u.createElement(he),register:u.createElement(ge),forgotPassword:u.createElement(pe),codeLogin:u.createElement(ye)},G=u.createContext({formMode:"login",setFormMode:()=>{}}),{Title:ct}=ee,ut={phoneNumber:"",captcha:""};function ye(){const[e,n]=u.useState(!1),[t]=N.useForm(),{t:r}=U(),{setFormMode:o}=u.useContext(G),a=async()=>{n(!0),setTimeout(()=>{var i;n(!1),(i=window.$message)==null||i.success(r("common.success"))},1e3)};return s.jsxs(s.Fragment,{children:[s.jsx(W,{direction:"vertical",children:s.jsx(ct,{level:3,children:r("authority.codeLogin")})}),s.jsxs(N,{name:"codeLoginForm",form:t,layout:"vertical",initialValues:ut,onFinish:a,children:[s.jsx(N.Item,{label:r("authority.mobile"),name:"phoneNumber",rules:st(r),children:s.jsx(Ae,{controls:!1,className:"w-full",placeholder:r("form.mobile.required")})}),s.jsx(tt,{label:r("authority.code"),placeholder:r("form.code.required"),captchaTextRender:(i,m)=>i?r("authority.sendText",{second:m}):r("authority.sendCode"),onGetCaptcha:()=>{var i;return(i=window.$message)==null||i.success(r("common.success")),Promise.resolve()},rules:[{required:!0}],phoneName:"phoneNumber",name:"captcha"}),s.jsx(N.Item,{children:s.jsx(V,{block:!0,type:"primary",htmlType:"submit",loading:e,children:r("authority.login")})}),s.jsx("div",{className:"text-sm text-center",children:s.jsx(R,{type:"link",icon:s.jsx(le,{}),className:"px-1",onPointerDown:()=>{o("login")},children:r("common.back")})})]})]})}const vt=Object.freeze(Object.defineProperty({__proto__:null,CodeLogin:ye},Symbol.toStringTag,{value:"Module"}));export{G as F,xt as a,vt as c,ht as f,gt as p,yt as r};
